//@version=5
indicator("ORB (Webull-ready)", overlay=true)

// Inputs
orbMinutes = input.int(5, "ORB total time (minutes)", minval=1)
sessionTime = input.session("0915-0920", "Session Time")
showOnIntraday = timeframe.isintraday and timeframe.multiplier <= orbMinutes

// Session detection
inSession = not na(time(timeframe.period, sessionTime + ":1234567"))
isFirstBarOfSession = inSession and not inSession[1]

// ORB values
var float orbHigh = na
var float orbLow = na

if isFirstBarOfSession
    orbHigh := high
    orbLow := low
else
    orbHigh := nz(orbHigh[1], high)
    orbLow := nz(orbLow[1], low)

if inSession and high > orbHigh
    orbHigh := high
if inSession and low < orbLow
    orbLow := low

// Plots
plot(showOnIntraday ? orbHigh : na, title="ORB High", linewidth=2, color=orbHigh[1] != orbHigh ? na : color.new(color.green, 0))
plot(showOnIntraday ? orbLow : na, title="ORB Low", linewidth=2, color=orbLow[1] != orbLow ? na : color.new(color.red, 0))
