//@version=4
study("ORB (Webull-ready)", overlay=true)

// Inputs (kept simple for Webull compatibility)
orbMinutes = input(5, title="ORB total time (minutes)", minval=1)
sessionTime = input("0915-0920", type=input.session, title="Session Time")
showOnIntraday = timeframe.isintraday and timeframe.multiplier <= orbMinutes

// Session detection
sessionBarTime = time(timeframe.period, sessionTime + ":1234567")
inSession = not na(sessionBarTime)
isFirstBarOfSession = inSession and not inSession[1]

// ORB values
float orbHigh = na
float orbLow = na

orbHigh := isFirstBarOfSession ? high : nz(orbHigh[1], high)
orbLow := isFirstBarOfSession ? low : nz(orbLow[1], low)

if inSession and high > orbHigh
    orbHigh := high
if inSession and low < orbLow
    orbLow := low

// Keep line break behavior when ORB value updates
orbHighPlot = showOnIntraday ? (orbHigh[1] != orbHigh ? na : orbHigh) : na
orbLowPlot = showOnIntraday ? (orbLow[1] != orbLow ? na : orbLow) : na

// Plots (Style tab editable in settings)
plot(orbHighPlot, title="ORB High", linewidth=2, color=color.green, style=plot.style_linebr)
plot(orbLowPlot, title="ORB Low", linewidth=2, color=color.red, style=plot.style_linebr)
