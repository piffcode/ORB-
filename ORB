//@version=5
indicator("ORB (Webull-ready)", overlay=true)

// Inputs
orbMinutes = input.int(5, "ORB total time (minutes)", minval=1)
sessionTime = input.session("0915-0920", "Session Time")
orbHighColor = input.color(color.green, "ORB High Color")
orbLowColor = input.color(color.red, "ORB Low Color")
showOnIntraday = timeframe.isintraday and timeframe.multiplier <= orbMinutes

// Session detection
inSession = not na(time(timeframe.period, sessionTime + ":1234567"))
isFirstBarOfSession = inSession and not inSession[1]

// ORB values
var float orbHigh = na
var float orbLow = na

if isFirstBarOfSession
    orbHigh := high
    orbLow := low
else
    orbHigh := nz(orbHigh[1], high)
    orbLow := nz(orbLow[1], low)

if inSession and high > orbHigh
    orbHigh := high
if inSession and low < orbLow
    orbLow := low

// Keep the same line-break behavior while allowing style customization in settings
orbHighPlot = showOnIntraday ? (orbHigh[1] != orbHigh ? na : orbHigh) : na
orbLowPlot = showOnIntraday ? (orbLow[1] != orbLow ? na : orbLow) : na

// Plots (editable from indicator settings)
plot(orbHighPlot, title="ORB High", linewidth=2, color=orbHighColor, style=plot.style_linebr)
plot(orbLowPlot, title="ORB Low", linewidth=2, color=orbLowColor, style=plot.style_linebr)
